name: "🚀 Test Cloudsmith CLI Installer"
on:
  workflow_dispatch:
  push:
permissions:
  contents: read
  id-token: write
jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os:
          - ubuntu-latest # 🐧
        install-method: [pip, executable]
        auth-method: [oidc]
    steps:
      - uses: actions/checkout@v4
      - name: "Set up Node.js"
        uses: actions/setup-node@v4
        with:
          node-version: "20"
      - name: "Install dependencies"
        run: npm install
      - name: "Build project"
        run: npm run build
      - name: "📦 Run Cloudsmith CLI Installer"
        uses: ./
        with:
          api-user-agent: "gha-test"
          oidc-namespace: "oidc"
          oidc-service-slug: "oidc"
